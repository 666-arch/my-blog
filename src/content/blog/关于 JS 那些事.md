---
author: Huang Chao
pubDatetime: 2023-03-23T11:18:53Z
modDatetime: 2023-03-24T01:22:56.066Z
title: "å…³äº JS é‚£äº›äº‹"
featured: true
draft: false
tags:
  - echarts
description: "JSç¢ç‰‡åŒ–"
---

## æœ‰å…³ null å’Œ undefined çš„åŒºåˆ«

- nullè¡¨ç¤º ä¸€ä¸ªç©ºæŒ‡é’ˆï¼Œå®ƒä¸æŒ‡å‘ä»»ä½•å¯¹è±¡ï¼Œæ˜¯æˆ‘ä»¬ä¸»åŠ¨èµ‹äºˆå˜é‡çš„ä¸€ä¸ªå€¼
- undefined åˆ™è¡¨ç¤ºä½ å£°æ˜äº†ä¸€ä¸ªå˜é‡ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰èµ‹å€¼æ“ä½œï¼Œæˆ–è€…è¯´å‡½æ•°æ²¡æœ‰è¿”å›å€¼çš„æ“ä½œï¼Œéƒ½ä¼šå‡ºç°undefinedçš„æƒ…å†µ

## è°ˆè°ˆé—­åŒ…

### é—­åŒ…ç¯å¢ƒå‡ºç°çš„æ¡ä»¶

```js
function x() {
  let count = 0;

  function y() {
    return (count += 1);
  }

  return y;
}

let fun = x();
console.log("count", fun()); // 1
console.log("count", fun()); // 2
```

å®ƒæ˜¯ç”±å¤šä¸ªå‡½æ•°åµŒå¥—å¼•ç”¨ï¼Œå¹¶ä¸”å¤šä¸ªå‡½æ•°ä½œç”¨åŸŸå†…é’ˆå¯¹æŸä¸ªå¤–éƒ¨å˜é‡è¿›è¡Œå†…éƒ¨å¼•ç”¨ï¼Œå¹¶ä¸”åªè¦è¿™ä¸ªå‡½æ•°ä¸é”€æ¯çš„æƒ…å†µä¸‹ï¼Œè¿™ä¸ªé—­åŒ…ä¸­çš„å˜é‡å°†ä¼šä¸€ç›´å­˜åœ¨

### é—­åŒ…çš„åº”ç”¨

- å‡½æ•°æŸ¯é‡ŒåŒ–
- å®ç°å‡½æ•°æ¨¡å—åŒ–
  - `count` æ˜¯ä¸€ä¸ªåˆ›å»ºäº `fun` å‡½æ•°ä½œç”¨åŸŸå†…çš„å˜é‡
  - é€šè¿‡åœ¨å†…éƒ¨å¤„ç† `count` çš„è¯»å–å’Œè®¾ç½®ï¼Œå¤–éƒ¨æ— æ³•ç›´æ¥è°ƒç”¨åˆ° count
  - é€šè¿‡æš´éœ²å…¬å…±æ–¹æ³•å»ä¾›å¤–éƒ¨è¯»å–

```js
function fun() {
  let count = 0;
  return {
    get() {
      return count; // ç§æœ‰å˜é‡ï¼Œå¤–éƒ¨æ— æ³•è®¿é—®
    },
    set() {
      count += 1;
    },
  };
}

let newFun = fun();
newFun.set();
console.log("result", newFun.get());
```

### æ³¨æ„äº‹é¡¹

> å¦‚æœé—­åŒ…é•¿æœŸå­˜åœ¨ï¼Œä¼šå®¹æ˜“å¯¼è‡´å†…å­˜æ³„éœ²ï¼Œå¤–éƒ¨å˜é‡ä¼šè¢«æ°¸è¿œæºå¸¦ï¼Œå¯ä»¥é€šè¿‡èµ‹å€¼ null çš„æ–¹å¼ é‡Šæ”¾é—­åŒ…

## JS ä¸­çš„å¼‚æ­¥ç¼–ç¨‹

> JS æœ¬èº«æ˜¯å•çº¿ç¨‹æ‰§è¡Œçš„ï¼Œç›¸å½“äºæ¯æ¬¡æ‰§è¡Œä¸€ä¸ª `task` éƒ½æ˜¯ä¸€ä¸ªä¸ªæ‰§è¡Œï¼Œä¸ºäº†å¤„ç†å¼‚æ­¥æ“ä½œï¼ŒJS å¼•å…¥äº†äº‹ä»¶å¾ªç¯ï¼ˆevent loopï¼‰

### å…³äºäº‹ä»¶å¾ªç¯ event loop

äº‹ä»¶å¾ªç¯æ˜¯ä¸æ–­çš„ä»æ–°çš„ä»»åŠ¡ä¸­å–å‡ºä»»åŠ¡å¹¶æ‰§è¡Œã€‚å¹¶ä¸”ä»»åŠ¡é˜Ÿåˆ—åˆ†ä¸ºå®ä»»åŠ¡é˜Ÿåˆ—å’Œå¾®ä»»åŠ¡é˜Ÿåˆ—

> å¾®ä»»åŠ¡é˜Ÿåˆ—ä¼˜å…ˆçº§é«˜äºå®ä»»åŠ¡é˜Ÿåˆ—

åœºæ™¯è®¾å®šğŸ”

æƒ³è±¡ä½ è¿›å…¥ä¸€ä¸ªå¿«é¤åº—ï¼ˆæµè§ˆå™¨ï¼‰ï¼Œé‡Œé¢åªæœ‰ä¸€ä¸ªå¨å¸ˆï¼ˆJSä¸»çº¿ç¨‹ï¼‰ï¼Œä½†æ˜¯é¡¾å®¢ï¼ˆtaskï¼‰å´å¾ˆå¤šã€‚è¿™ä¸ªæ—¶å€™ JS å¼•å…¥äº†ä¸€å¥—é«˜æ•ˆçš„æ’é˜Ÿç³»ç»Ÿ

1. åŒæ­¥ä»»åŠ¡

ä»»åŠ¡ä¸€ä¸ªä¸€ä¸ªæ‰§è¡Œï¼Œæ‰§è¡Œå®Œä¸€ä¸ªæ‰§è¡Œä¸‹ä¸€ä¸ª

```js
console.log("ç‚¹æ±‰å ¡");
console.log("ç‚¹è–¯æ¡");
```

2. å¼‚æ­¥ä»»åŠ¡

å®ä»»åŠ¡ï¼š

å¼€è®¾ä¸€ä¸ªæ–°çš„çª—å£ï¼ˆå¤–å–çª—å£ï¼‰é€šè¿‡ `WebAPI` è¿›è¡Œè®¡æ—¶

```js
setTimeout(() => {
  console.log("å¤–å–");
}, 0);
```

- å¨å¸ˆè¿˜æ˜¯ä¼šä¼˜å…ˆå¤„ç†åŒæ­¥ä»»åŠ¡
- åŒæ­¥ä»»åŠ¡å…¨éƒ¨å¤„ç†å®Œæˆï¼Œå¤„ç†å¤–å–ä»»åŠ¡
- å¤–å–ä»»åŠ¡å®Œæˆï¼Œæ·»åŠ åˆ°å¤–å–é˜Ÿåˆ—

å¾®ä»»åŠ¡ï¼š

å¼€è®¾ä¸€ä¸ªè®¢å•åŠ æ€¥çª—å£ï¼Œå¤„ç†åŠ æ€¥è®¢å•ï¼ˆä»»åŠ¡ï¼‰

```js
Promise.resolve().then(() => {
  console.log("åŠ æ€¥è®¢å•");
});
```

- æŠŠå®Œæˆçš„è®¢å•ï¼ˆä»»åŠ¡ï¼‰æ”¾è¿›åŠ æ€¥è®¢å•ä¸­
- å½“å¨å¸ˆæŠŠæ‰‹å¤´ä»»åŠ¡ï¼ˆåŒæ­¥ï¼‰å…¨éƒ¨å®Œæˆï¼Œå†å¤„ç†åŠ æ€¥è®¢å•ï¼Œå“ªæ€•å¤–å–çª—å£æœ‰å…¶ä»–è®¢å•ç­‰å¾…ï¼

æ‰§è¡Œæµç¨‹ï¼š

- å¨å¸ˆä¼šä¼˜å…ˆå¤„ç†åŒæ­¥ä»»åŠ¡ä¸­çš„æ‰€æœ‰ä»»åŠ¡
- æ£€æŸ¥å¾®ä»»åŠ¡é˜Ÿåˆ—ä¸­æ˜¯å¦æœ‰æ–°çš„ä»»åŠ¡ï¼Œç­‰åŒæ­¥å¤„ç†å®Œä¼˜å…ˆå¤„ç†
- æ£€æŸ¥å®ä»»åŠ¡é˜Ÿåˆ—ä¸­æ˜¯å¦æœ‰æ–°çš„ä»»åŠ¡ï¼Œå¦‚æœæœ‰ï¼Œåªå¤„ç†ä¸€ä¸ª
- å¾ªç¯å¾€å¤ï¼Œç›´åˆ°é˜Ÿåˆ—ä»»åŠ¡å…¨éƒ¨æ¸…ç©º

## JS å¦‚ä½•æ„é€ ä¸€ä¸ªä¸€ç™¾ä¸ªå…¨ä¸º 0 çš„æ•°ç»„

- é€šè¿‡ Array.fill
  > ç”¨äºå¡«å……ä¸€ä¸ªå›ºå®šå€¼åˆ°æ•°ç»„ä¸­ï¼Œä»èµ·å§‹ç´¢å¼•åˆ°ç»ˆæ­¢ç´¢å¼•

```js
new Array(100).fill(0);
```

## ES6ä¸­å¿…é¡»è¦çŸ¥é“çš„ï¼Ÿ

### letã€constã€var åŒºåˆ«ï¼Ÿ

- var çš„å˜é‡æå‡

é¦–å…ˆ è¿™ä¸‰ä¸ªéƒ½æ˜¯å¯ä»¥å»å®šä¹‰ä¸€ä¸ªä»»æ„ç±»å‹çš„å˜é‡
`var` å…¶å®æ˜¯ Javascript çš„ä¸€ä¸ª `bug`ï¼Œåœ¨å®šä¹‰å˜é‡æ—¶ï¼Œå¯ä»¥åœ¨ä¸åˆå§‹åŒ–èµ‹å€¼çš„æƒ…å†µä¸‹ç›´æ¥ä½¿ç”¨å¹¶ä¸”æµè§ˆå™¨åªä¼šè­¦å‘Šå¯èƒ½å­˜åœ¨ undefined
æƒ…å†µï¼Œä¸ä¼šç›´æ¥å‘ŠçŸ¥å¼€å‘è€…å¹¶ä¸”æŠ›å‡ºå¼‚å¸¸
è¿™å°±æ˜¯ `å˜é‡æå‡`

```js
console.log(a); // undefined
var a = 10;
```

- var å­˜åœ¨ `å‡½æ•°ä½œç”¨åŸŸ` æˆ–è€… `å…¨å±€ä½œç”¨åŸŸ`

`if` å—å¤–éƒ¨ ä»ç„¶å¯ä»¥è®¿é—® x å˜é‡ï¼Œæ˜¾ç„¶ä¸å¦¥ã€‚

```js
function fun() {
  if (true) {
    var x = 10;
  }
  console.log(x); // 10
}

fun();
```

- `let`ï¼Œ`const` å®ƒä»¬éƒ½å…·æœ‰ `å—çº§ä½œç”¨åŸŸ`ã€‚

ä¸€ä¸ªæ˜¯ä½œä¸ºå˜é‡å­˜å‚¨ã€ä¸€ä¸ªæ˜¯ä½œä¸ºå¸¸é‡å­˜å‚¨ï¼Œä»–ä»¬çš„å‡ºç°å°±æ˜¯ä¸ºäº†è§£å†³ `var` å¸¦æ¥ bug

æ‰€è°“å˜é‡ å°±æ˜¯åœ¨è¿›è¡Œåˆå§‹åŒ–èµ‹å€¼åï¼Œå¯ä»¥å˜åŒ–ä¿®æ”¹çš„å€¼

æ‰€è°“å¸¸é‡ å°±æ˜¯ä¸€æ—¦å®Œæˆåˆå§‹åŒ–èµ‹å€¼åï¼Œæ— æ³•è½»æ˜“çš„ä¿®æ”¹å€¼ï¼ˆä½†å­˜åœ¨ç‰¹æ®Šæƒ…å†µï¼‰

```js
function fun() {
  if (true) {
    const x = 10;
    let y = 20;
  }
  console.log(x); // æŠ¥é”™ï¼šx is not defined
  console.log(y); // æŠ¥é”™ï¼šy is not defined
}

fun();
```

### ç®­å¤´å‡½æ•°æ‡‚å—ï¼Ÿ

1. ç‰¹æ€§

ç®­å¤´å‡½æ•°æ— éœ€é€šè¿‡ `function` å»å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œé€šè¿‡æ‹¬å· + è¡¨è¾¾å¼çš„å½¢å¼å»å®šä¹‰
è¯­æ³•æ˜¯ï¼šå½“å‚æ•°åªæœ‰ä¸€ä¸ªæ—¶ï¼Œå¯ä»¥çœç•¥æ‹¬å·ï¼Œå½“è¡¨è¾¾å¼ä¹Ÿæ˜¯å•ä¸ªæ—¶å¯ä»¥éšå¼çš„è¿”å›

å³ï¼š

```js
const fun = (a, b) => {
  a + b;
};
```

2. ä¸å­˜åœ¨ `this` æŒ‡å‘çš„é—®é¢˜

- ç®­å¤´å‡½æ•°è‡ªåŠ¨ç»§æ‰¿å¤–å±‚ä½œç”¨åŸŸï¼ˆé™æ€ç»‘å®šï¼‰

è¿™ä½¿å¾—ç®­å¤´å‡½æ•°åœ¨å›è°ƒå‡½æ•°æ¯”å¦‚ï¼ˆsetTimeout æˆ–è€… reactäº‹ä»¶å¤„ç†ï¼‰ä¸­éå¸¸æœ‰ç”¨

```js
function timer() {
  this.seconds = 0;
  //ä¼ ç»Ÿå‡½æ•°ä¸‹ï¼šthisæŒ‡å‘çš„æ˜¯è°ƒç”¨è€…ï¼ˆå¯èƒ½å‡ºç°thisä¸¢å¤±ï¼‰
  setTimeout(function a() {
    this.seconds++;
  }, 1000);
  //ç®­å¤´å‡½æ•°ä¸‹ï¼šthisç›´æ¥ç»§æ‰¿å¤–éƒ¨å‡½æ•°çš„å®ä¾‹
  setTimeout(() => {
    this.seconds++;
  }, 1000);
}
```

- é¿å…äº†åœ¨ `setTimeout`ã€äº‹ä»¶å¤„ç†å‡½æ•°ã€æˆ–è€…æ•°ç»„æ–¹æ³•ä¸­ this çš„æŒ‡å‘é—®é¢˜

```js
// æ™®é€šå‡½æ•°éœ€è¦é¢å¤–é€šè¿‡ bind ç»‘å®šthis
button
  .addListener("click", function () {
    this.classList.toggle("active");
  })
  .bind(this);

//ç®­å¤´å‡½æ•° è‡ªåŠ¨ç»§æ‰¿å¤–å±‚å‡½æ•°ç¤ºä¾‹
button.addListener("click", () => {
  this.classList.toggle("active");
});
```

- æ²¡æœ‰åŸå‹å±æ€§ï¼ˆprototypeï¼‰ï¼Œæ‰€ä»¥æ— æ³•ä½œä¸ºå¯¹è±¡çš„è‡ªèº«å±æ€§å»è®¿é—®

```js
const obj = {
  a: 1,
  b: () => this.a, //é”™è¯¯ã€‚ï¼Œæ­¤æ—¶ this æŒ‡å‘å…¨å±€å¯¹è±¡
};
```

- ç®­å¤´å‡½æ•°ç¬¦åˆå‡½æ•°å¼ç¼–ç¨‹çš„é£æ ¼ï¼Œæé«˜ä»£ç å¯è¯»æ€§ï¼Œç»´æŠ¤æ€§

ç®€åŒ–åƒ `map`ã€`filter`ã€`reduce`ç­‰é’ˆå¯¹æ•°ç»„çš„ä¸€äº›æ“ä½œ

```js
const nums = [1, 2, 3];
const squera = nums.map(x => x * x);
```

### JSçš„é˜²æŠ–å’ŒèŠ‚æµï¼Ÿ

é˜²æŠ–ï¼šdebounce(f, wait)

> é¿å…é¢‘ç¹çš„é’ˆå¯¹æŸä¸€äº‹ä»¶æµè¿›è¡Œå¤šæ¬¡é¢‘ç¹çš„è§¦å‘ï¼Œä¹Ÿå°±æ˜¯åªè®¾ç½®åœ¨å•ä½æ—¶é—´å†…åªæœ‰æ•ˆè§¦å‘æœ€åä¸€æ¬¡

- åº”ç”¨åœºæ™¯ï¼š
  - ç”¨æˆ·ç™»å½•ï¼Œé¢‘ç¹çš„ç‚¹å‡»ç™»å½•æŒ‰é’®
  - ç”¨æˆ·å‘é€çŸ­ä¿¡ï¼Œå‘é€å¤ªå¤šçš„è¯·æ±‚
  - è°ƒæ•´æµè§ˆå™¨çª—å£ä¼šé€ æˆ resize é¢‘ç¹è®¡ç®—è¿‡å¤š
  - æ–‡æœ¬ç¼–è¾‘å™¨çš„å®æ—¶ä¿å­˜ï¼Œåªä¿å­˜æœ‰æ•ˆçš„æœ€åä¸€æ¬¡è§¦å‘
- é˜²æŠ–æ ¸å¿ƒ
  - åœ¨äº `clearTimeout(timer)` çš„æ¸…é›¶

ä¸¾ä¾‹è¯´æ˜ï¼š

åç”µæ¢¯æ—¶ï¼Œæ¯”å¦‚æŒ‰ä¸‹å…³é—¨æŒ‰é’® åˆ° å…³é—­å®Œæˆ è¿™ä¸€æ—¶é—´ä¸º `3s`ï¼Œå¦‚æœåœ¨è¿™ `3s` å†…å¤–é¢è¿˜æœ‰äººæŒ‰å¼€é—¨æŒ‰é’®ï¼Œé‚£æ­¤æ¬¡çš„å…³é—¨æŒ‰é’®ä¸ä½œä¸ºè§¦å‘çš„æ‰§è¡Œäº‹ä»¶ï¼Œå¹¶ä¸”é‡æ–°å¼€å§‹è®¡æ—¶ã€‚
ä»¥æ­¤ç±»æ¨ï¼Œåªè¦å•ä½æ—¶é—´å†…ä¸€äººæœ‰å¼€é—¨ï¼Œéƒ½ä¸æš‚æ—¶ä½œä¸ºæœ€åä¸€æ¬¡äº‹ä»¶æ‰§è¡Œã€‚åªæœ‰é—¨çœŸæ­£å…³é—­ï¼Œé‚£ä¹ˆæœ€åä¸€æ¬¡çš„äº‹ä»¶æ‰ä¼šä½œä¸ºæ‰§è¡Œäº‹ä»¶è§¦å‘ã€‚

èŠ‚æµï¼šthrottle(f, wait)

> ä¹Ÿæ˜¯æ§åˆ¶äº‹ä»¶å‘ç”Ÿçš„é¢‘ç‡ï¼Œæ¯”å¦‚æ§åˆ¶ 1s å‘ç”Ÿä¸€æ¬¡ï¼Œç”šè‡³æ˜¯ 1åˆ†é’Ÿ å‘ç”Ÿä¸€æ¬¡

- åº”ç”¨åœºæ™¯
  - scroll æ»šåŠ¨äº‹ä»¶ï¼Œæ¯éš” 1s å°±é‡æ–°è®°å½•ä¸€æ¬¡ä½ç½®ä¿¡æ¯
  - æµè§ˆå™¨çš„æ’­æ”¾äº‹ä»¶ï¼Œæ¯éš” 1s å°±é‡æ–°è®°å½•æ’­æ”¾çš„ä¸€ä¸ªè¿›åº¦ä¿¡æ¯
  - input æœç´¢æ¡†ï¼Œå‘é€è¯·æ±‚ä¸‹æ‹‰åˆ—è¡¨
- èŠ‚æµæ ¸å¿ƒ
  - åœ¨äº åŠ é”å’Œé‡ç½®é” `timer=setTimeout`ã€`timer = null`

ä¸¾ä¾‹è¯´æ˜ï¼šèŠ‚æµå¯ä»¥æ¯”ä½œç­‰çº¢ç»¿ç¯ï¼Œå½“ç»¿ç¯è§¦å‘åˆ°å¼€å¯çº¢ç¯è¿™æ®µäº‹ä»¶ï¼Œå¯ä»¥ä¸€æ¬¡é€šè¿‡ä¸€æ‰¹è½¦è¾†

### JS ç±»æ•°ç»„è½¬æ¢æ•°ç»„ï¼Ÿ

ä»€ä¹ˆæ˜¯ç±»æ•°ç»„ï¼Ÿ

> ä¸€ä¸ªå¯¹è±¡æœ‰ length å±æ€§ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡ç´¢å¼•è®¿é—®å…ƒç´ ï¼Œä½†æ˜¯ä¸å…·å¤‡çº¯æ•°ç»„çš„æ–¹æ³•

- `Array.from`

æœ€ç›´æ¥çš„æ–¹æ³•å°±æ˜¯é€šè¿‡ `Array.from` çš„æ–¹å¼è¿›è¡Œè½¬æ¢

```js
const objToArray = {
  0: "apple",
  1: "orange",
  length: 2,
};
const arr = Array.from(objToArray);
// ['apple', 'orange']
```

- `Array.prototype.slice.call`

é€šè¿‡æ•°ç»„åŸå‹ `Array.prototype.slice.call`

```js
const objToArray = {
  0: "red",
  1: "blue",
  length: 2,
};
const arr = Array.prototype.slice.call(objToArray);
// ['red', 'blue']
```

### åŸå‹å’ŒåŸå‹é“¾ï¼Ÿ

> åœ¨ JS ä¸­ä¸‡ç‰©çš†å¯ä»¥æ˜¯å¯¹è±¡ï¼Œé‚£ä¹ˆå‡½æ•°ä¹Ÿæ˜¯å¯¹è±¡ï¼ŒåŸå‹ä¹Ÿæ˜¯å¯¹è±¡ï¼Œæ‰€æœ‰å¯¹è±¡éƒ½å­˜åœ¨ _proto_ å±æ€§ï¼Œè€Œå‡½æ•°æ‹¥æœ‰ç‰¹æ®Šçš„ prototype å±æ€§

åŸå‹é“¾çš„æœ¬è´¨ï¼š

æœ¬è´¨å…¶å®å°±æ˜¯é€šè¿‡ `_proto_` å±æ€§åƒæ¢¯å­ä¸€æ ·é€çº§çš„å‘ä¸ŠæŸ¥æ‰¾ï¼Œç›´åˆ°æ‰¾åˆ°å±æ€§æˆ–è€… `null`ï¼ˆæœ€é¡¶å±‚çš„åŸå‹ï¼ŒåŸå‹é“¾ç»ˆç‚¹ï¼‰

åŸå‹å’ŒåŸå‹é“¾ä¹‹é—´å°±è¡Œ `DNAæ¨¡å‹` æ„é€ å‡½æ•°çš„ `prototype` å±æ€§å°±åƒåŸºå› åº“ï¼Œ`_proto_` å°±åƒç»§æ‰¿åŸºå› 

åœ¨ JS `OOP` é¢å‘å¯¹è±¡ç¼–ç¨‹æ€æƒ³ä¸­ï¼Œæœ¬è´¨å°±æ˜¯é€šè¿‡åŸå‹å§”æ‰˜æœºåˆ¶ï¼Œå®ƒä¸æ˜¯å¤åˆ¶å„å¯¹è±¡çš„å±æ€§ï¼Œè€Œæ˜¯é€šè¿‡é“¾æ¡çš„å½¢å¼å»ºç«‹å„å¯¹è±¡ç›´æ¥çš„å¼•ç”¨è¿æ¥ã€‚

åº”ç”¨åœºæ™¯ï¼š

- å¯ä»¥å®ç°æ–¹æ³•ç»§æ‰¿ï¼Œé€šè¿‡ ç±» å’Œå®ä¾‹å¯¹è±¡çš„ç»§æ‰¿å…³ç³»ï¼Œè®¿é—®å…¶å†…éƒ¨è¢«å…¬å¼€çš„æ–¹æ³•

### æµ…æ‹·è´ å’Œ æ·±æ‹·è´ï¼Ÿ

é¦–å…ˆæµ…æ‹·è´å’Œæ·±æ‹·è´éƒ½æ˜¯é’ˆå¯¹å¯¹è±¡è¿›è¡Œçš„å¤åˆ¶ï¼ŒåŒºåˆ«åœ¨å¤åˆ¶çš„å±‚çº§ï¼š

|     ç‰¹æ€§     |          æµ…æ‹·è´          |              æ·±æ‹·è´              |
| :----------: | :----------------------: | :------------------------------: |
|   å¤åˆ¶å±‚çº§   |     ä»…å¤åˆ¶ç¬¬ä¸€å±‚å±æ€§     |      é€’å½’å¤åˆ¶æ‰€æœ‰åµŒå¥—çš„å±æ€§      |
| å¼•ç”¨ç±»å‹å¤„ç† | å¤åˆ¶ä¸€ä»½å¼•ç”¨åœ°å€è¿›è¡Œå…±äº« | åˆ›å»ºå‡ºä¸€ä¸ªå…¨æ–°å¯¹è±¡å¼€è¾Ÿä¸€ä¸ªæ–°ç©ºé—´ |
|   ä¿®æ”¹å½±å“   | ä¿®æ”¹åµŒå¥—å¯¹è±¡ä¼šå½±å“åŸå±æ€§ |    ä¿®æ”¹ä»»ä½•å¯¹è±¡ä¸ä¼šå½±å“åŸå±æ€§    |

#### å“ªäº›æ–¹æ³•å¯ä»¥å®ç° æµ…æ‹·è´

- ç›´æ¥èµ‹å€¼ï¼ˆä¸æ˜¯æ‹·è´ï¼Œåªæ˜¯å¼•ç”¨çš„ä¼ é€’ï¼‰

```js
const obj = { a: 1, nested: { b: 2 } };
const _obj = obj; //åªæ˜¯å¼•ç”¨çš„ä¼ é€’
_obj.a = 999;
console.log(obj.a); // 999 åŸå¯¹è±¡è¢«ä¿®æ”¹
```

- Object.assign()

```js
const obj = { a: 1, nested: { b: 2 } };
const _obj = Object.assign({}, obj);
_obj.nested.b = 999;
console.log(obj.nested.b); // 999 æµ…æ‹·è´é™·é˜±
```

- å±•å¼€è¿ç®—ç¬¦

```js
const obj = { a: 1, nested: { b: 2 } };
const _obj = { ...obj };
_obj.nested.b = 666;
console.log(_obj.nested.b); // 666 åŒæ ·å½±å“åŸå¯¹è±¡
```

#### å“ªäº›æ–¹æ³•å¯ä»¥å®ç° æ·±æ‹·è´

- JSON.parse(JSON.stringify()) æœ€å¿«æ·æ–¹å¼

```js
const obj = { a: 1, nested: { b: 2 } };
const deepCopy = { ...obj };
deepCopy.nested.b = 666;
console.log(deepCopy.nested.b); // ä¿æŒåŸå€¼ -> æˆåŠŸæ·±æ‹·è´
```

ä½†æ˜¯è¿™ç§æ–¹æ³•å­˜åœ¨å±€é™æ€§ï¼š

- ä¸¢å¤± undefinedã€functionç­‰ç±»å‹
- æ—¥æœŸå¯¹è±¡ä¼šè¢«è½¬æ¢ä¸ºå­—ç¬¦ä¸²

ä½¿ç”¨ç¬¬ä¸‰æ–¹åº“ Lodashçš„ \_.cloneDeep æ–¹æ³•

æ‰‹åŠ¨å®ç°ä¸€ä¸ªæ·±æ‹·è´

```js
function cloneDeep(source: any, map = new WeakMap()){
  //åŸºç¡€çš„ç±»å‹ç›´æ¥è¿”å›
  if(typeof source !== 'object' || source === null) return source;
  //å¤„ç†å¾ªç¯å¼•ç”¨ï¼Œé¿å…æ— æ•ˆé€’å½’
  if(map.has(source)) return map.get(source);
  //åŠ¨æ€åˆ›å»ºå‰¯æœ¬ï¼Œå¦‚æœæ˜¯æ•°ç»„ -> []
  const target = Array.isArray(source) ? [] : {};
  map.set(source, target)
  //å¼€å§‹é€’å½’æ‹·è´å±æ€§
  for (const key in source) {
    //æ ¹æ®keyæ‹·è´
    if (source.hasOwnProperty(key)) {
      //é€’å½’å¼•ç”¨èµ‹å€¼
      target[key] = cloneDeep(source[key], map);
    }
  }
  //è¿”å›é€’å½’å®Œæˆåçš„æ–°å¯¹è±¡
  return target;
}
```
